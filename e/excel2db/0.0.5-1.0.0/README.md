# Comparing `tmp/excel2db-0.0.5.tar.gz` & `tmp/excel2db-1.0.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist\excel2db-0.0.5.tar", last modified: Fri May  3 08:35:54 2024, max compression
+gzip compressed data, was "dist\excel2db-1.0.0.tar", last modified: Sat May  4 04:51:08 2024, max compression
```

## Comparing `excel2db-0.0.5.tar` & `excel2db-1.0.0.tar`

### file list

```diff
@@ -1,37 +1,36 @@
-drwxrwxrwx   0        0        0        0 2024-05-03 08:35:54.000000 excel2db-0.0.5/
--rw-rw-rw-   0        0        0      171 2024-05-03 08:35:54.000000 excel2db-0.0.5/PKG-INFO
-drwxrwxrwx   0        0        0        0 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db/
--rw-rw-rw-   0        0        0        0 2024-04-24 13:59:30.000000 excel2db-0.0.5/excel2db/__init__.py
--rw-rw-rw-   0        0        0    19638 2024-04-30 04:24:41.000000 excel2db-0.0.5/excel2db/cheakConf.py
-drwxrwxrwx   0        0        0        0 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db/com/
--rw-rw-rw-   0        0        0        0 2024-04-25 02:12:38.000000 excel2db-0.0.5/excel2db/com/__init__.py
-drwxrwxrwx   0        0        0        0 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db/com/util/
--rw-rw-rw-   0        0        0        0 2024-04-25 02:12:38.000000 excel2db-0.0.5/excel2db/com/util/__init__.py
--rw-rw-rw-   0        0        0     8036 2023-06-28 01:48:10.000000 excel2db-0.0.5/excel2db/com/util/coordinate.py
--rw-rw-rw-   0        0        0     3847 2024-05-03 08:31:30.000000 excel2db-0.0.5/excel2db/com/util/dbconnect.py
--rw-rw-rw-   0        0        0     3933 2024-03-01 03:05:42.000000 excel2db-0.0.5/excel2db/com/util/excelTool.py
--rw-rw-rw-   0        0        0     6194 2023-10-17 13:38:33.000000 excel2db-0.0.5/excel2db/com/util/fileTool.py
--rw-rw-rw-   0        0        0     8838 2024-04-30 03:24:30.000000 excel2db-0.0.5/excel2db/com/util/timeTool.py
--rw-rw-rw-   0        0        0     5520 2024-04-30 06:48:39.000000 excel2db-0.0.5/excel2db/defaultConf.py
-drwxrwxrwx   0        0        0        0 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db/demo/
--rw-rw-rw-   0        0        0        0 2024-05-03 08:34:25.000000 excel2db-0.0.5/excel2db/demo/__init__.py
--rw-rw-rw-   0        0        0     7637 2024-05-03 08:34:25.000000 excel2db-0.0.5/excel2db/demo/generalDemoFile.py
--rw-rw-rw-   0        0        0     2646 2024-04-30 04:24:41.000000 excel2db-0.0.5/excel2db/detailData.py
--rw-rw-rw-   0        0        0     2653 2024-04-30 04:24:41.000000 excel2db-0.0.5/excel2db/detailTitle.py
--rw-rw-rw-   0        0        0     2527 2024-04-30 03:24:30.000000 excel2db-0.0.5/excel2db/excel.py
--rw-rw-rw-   0        0        0      712 2024-04-30 03:24:30.000000 excel2db-0.0.5/excel2db/excel2db.py
--rw-rw-rw-   0        0        0     2050 2024-04-30 03:24:30.000000 excel2db-0.0.5/excel2db/extraFuction.py
--rw-rw-rw-   0        0        0     5816 2024-05-03 07:45:33.000000 excel2db-0.0.5/excel2db/insert2sqlite.py
--rw-rw-rw-   0        0        0     3057 2024-04-30 03:27:24.000000 excel2db-0.0.5/excel2db/mainData.py
--rw-rw-rw-   0        0        0     5144 2024-04-30 07:41:06.000000 excel2db-0.0.5/excel2db/mainTitle.py
--rw-rw-rw-   0        0        0     6943 2024-04-30 03:27:24.000000 excel2db-0.0.5/excel2db/scale.py
--rw-rw-rw-   0        0        0     5228 2024-04-30 04:24:41.000000 excel2db-0.0.5/excel2db/sheet.py
--rw-rw-rw-   0        0        0     7182 2024-05-03 07:45:33.000000 excel2db-0.0.5/excel2db/value.py
-drwxrwxrwx   0        0        0        0 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db.egg-info/
--rw-rw-rw-   0        0        0      171 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      736 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       16 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db.egg-info/requires.txt
--rw-rw-rw-   0        0        0        9 2024-05-03 08:35:54.000000 excel2db-0.0.5/excel2db.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2024-05-03 08:35:54.000000 excel2db-0.0.5/setup.cfg
--rw-rw-rw-   0        0        0      493 2024-04-30 08:12:26.000000 excel2db-0.0.5/setup.py
+drwxrwxrwx   0        0        0        0 2024-05-04 04:51:08.000000 excel2db-1.0.0/
+-rw-rw-rw-   0        0        0      171 2024-05-04 04:51:08.000000 excel2db-1.0.0/PKG-INFO
+drwxrwxrwx   0        0        0        0 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db/
+-rw-rw-rw-   0        0        0        0 2024-04-24 13:59:30.000000 excel2db-1.0.0/excel2db/__init__.py
+-rw-rw-rw-   0        0        0    20055 2024-05-04 04:40:02.000000 excel2db-1.0.0/excel2db/cheakConf.py
+drwxrwxrwx   0        0        0        0 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db/com/
+-rw-rw-rw-   0        0        0        0 2024-04-25 02:12:38.000000 excel2db-1.0.0/excel2db/com/__init__.py
+drwxrwxrwx   0        0        0        0 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db/com/util/
+-rw-rw-rw-   0        0        0        0 2024-04-25 02:12:38.000000 excel2db-1.0.0/excel2db/com/util/__init__.py
+-rw-rw-rw-   0        0        0     8036 2023-06-28 01:48:10.000000 excel2db-1.0.0/excel2db/com/util/coordinate.py
+-rw-rw-rw-   0        0        0     3847 2024-05-03 08:31:30.000000 excel2db-1.0.0/excel2db/com/util/dbconnect.py
+-rw-rw-rw-   0        0        0     3933 2024-03-01 03:05:42.000000 excel2db-1.0.0/excel2db/com/util/excelTool.py
+-rw-rw-rw-   0        0        0     6194 2023-10-17 13:38:33.000000 excel2db-1.0.0/excel2db/com/util/fileTool.py
+-rw-rw-rw-   0        0        0     8838 2024-04-30 03:24:30.000000 excel2db-1.0.0/excel2db/com/util/timeTool.py
+-rw-rw-rw-   0        0        0     5850 2024-05-03 16:31:37.000000 excel2db-1.0.0/excel2db/defaultConf.py
+drwxrwxrwx   0        0        0        0 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db/demo/
+-rw-rw-rw-   0        0        0        0 2024-05-03 08:34:25.000000 excel2db-1.0.0/excel2db/demo/__init__.py
+-rw-rw-rw-   0        0        0    11976 2024-05-04 02:37:33.000000 excel2db-1.0.0/excel2db/demo/generalDemoFile.py
+-rw-rw-rw-   0        0        0     2646 2024-04-30 04:24:41.000000 excel2db-1.0.0/excel2db/detailData.py
+-rw-rw-rw-   0        0        0     2653 2024-04-30 04:24:41.000000 excel2db-1.0.0/excel2db/detailTitle.py
+-rw-rw-rw-   0        0        0     2527 2024-04-30 03:24:30.000000 excel2db-1.0.0/excel2db/excel.py
+-rw-rw-rw-   0        0        0      918 2024-05-03 15:59:49.000000 excel2db-1.0.0/excel2db/excel2db.py
+-rw-rw-rw-   0        0        0     5816 2024-05-03 07:45:33.000000 excel2db-1.0.0/excel2db/insert2sqlite.py
+-rw-rw-rw-   0        0        0     3057 2024-04-30 03:27:24.000000 excel2db-1.0.0/excel2db/mainData.py
+-rw-rw-rw-   0        0        0     5144 2024-04-30 07:41:06.000000 excel2db-1.0.0/excel2db/mainTitle.py
+-rw-rw-rw-   0        0        0     8032 2024-05-04 04:37:58.000000 excel2db-1.0.0/excel2db/scale.py
+-rw-rw-rw-   0        0        0     5228 2024-04-30 04:24:41.000000 excel2db-1.0.0/excel2db/sheet.py
+-rw-rw-rw-   0        0        0     7137 2024-05-03 16:00:40.000000 excel2db-1.0.0/excel2db/value.py
+drwxrwxrwx   0        0        0        0 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db.egg-info/
+-rw-rw-rw-   0        0        0      171 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      711 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       21 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        9 2024-05-04 04:51:08.000000 excel2db-1.0.0/excel2db.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2024-05-04 04:51:08.000000 excel2db-1.0.0/setup.cfg
+-rw-rw-rw-   0        0        0      500 2024-05-04 04:43:31.000000 excel2db-1.0.0/setup.py
```

### Comparing `excel2db-0.0.5/excel2db/cheakConf.py` & `excel2db-1.0.0/excel2db/cheakConf.py`

 * *Files 2% similar despite different names*

```diff
@@ -535,24 +535,33 @@
             confTemp.pop(indexList[-1])
             indexList = indexList[:-1]
 
     return confTemp
 
 def scaleConf(value, conf):
     """
-    :param conf: detailData级别配置文件（清洗前）
+    :param conf: scaleData级别配置文件（清洗前）
     """
     confTemp = {}
 
     for item in defaultConf.scale:
         if item in conf: ##若配置则使用配置的值
             confTemp[item] = returnTrue(conf[item])
+
+            if item in ("dateFormat"):
+                for itemIn in defaultConf.scale[item]:
+                    if itemIn in conf[item]:  ##若配置则使用配置的值
+                        confTemp[item][itemIn] = returnTrue(conf[item][itemIn])
+                    else:  ##若未配置则使用默认值
+                        confTemp[item][itemIn] = returnTrue(defaultConf.scale[item][itemIn])
         else: ##若未配置则使用默认值
             confTemp[item] = returnTrue(defaultConf.scale[item])
 
+
+
     confTemp["coordinate"] = returnTrue(conf["coordinate"])
 
     value.scaleConf = confTemp
 
 def returnTrue(obj):
     """
     判断是否为序列类型,并返回一个全新变量
```

### Comparing `excel2db-0.0.5/excel2db/com/util/coordinate.py` & `excel2db-1.0.0/excel2db/com/util/coordinate.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/com/util/dbconnect.py` & `excel2db-1.0.0/excel2db/com/util/dbconnect.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/com/util/excelTool.py` & `excel2db-1.0.0/excel2db/com/util/excelTool.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/com/util/fileTool.py` & `excel2db-1.0.0/excel2db/com/util/fileTool.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/com/util/timeTool.py` & `excel2db-1.0.0/excel2db/com/util/timeTool.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/defaultConf.py` & `excel2db-1.0.0/excel2db/defaultConf.py`

 * *Files 8% similar despite different names*

```diff
@@ -38,50 +38,59 @@
             "columnName": "" ##数据库字段名，当该配置不存在时，取titleName
         },
     ],
     "titleList" : [] ##默认值为[]，代表获取所有标题列
 
 }##下级选项为"scaleList" : [], ##存储范围调整，靠后的优先级高,具体配置文件参考scale
 mainData = { ##注意，主表数据只取配置好的标题中对应的数据
-    "mainDataTypes":{
-
-    },
+    # "mainDataTypes":{
+    #
+    # },
     "mainDataRows" : [], ##数据行取舍规则,只获取结果为True的数据，传入参数为row，mainData的第一行row为1,例如"row%2==1"
 }##下级选项为"scaleList" : [], ##存储范围调整，靠后的优先级高,具体配置文件参考scale
 detailTitle = {
     "detailTitleName":[], ##明细表标题名
 }##下级选项为"scaleList" : [], ##存储范围调整，靠后的优先级高,具体配置文件参考scale
 detailData = {
-    "detailDataType": {
-
-    },
+    # "detailDataType": {
+    #
+    # },
 }##下级选项为"scaleList" : [], ##存储范围调整，靠后的优先级高,具体配置文件参考scale
 scale = {
     "start" : "默认为当前范围左上角",
     "rows": 0, ##获取指定行数，0表示所有，默认为0
     "columns": 0, ##获取指定列数，0表示所有，默认为0
-    "replaceAll": { ##整个单元格匹配才替换
-
-    },
-    "replaceSome":{ ##包含即替换,
-
-    },
+    "replaceAll" : [ ##整个单元格匹配才替换
+        {
+            "iniData" : "", ##源数据
+            "data" : "", ##目标数据
+        }
+    ],
+    "replaceAll" : [],
+    "replaceSome":[ ##包含即替换
+        {
+            "iniData" : "", ##源数据
+            "data" : "", ##目标数据
+        }
+    ],
+    "replaceSome" : [],
     "isDateFormat" : False, ##是否调整日期格式
     "dateFormat" : { #当"isDateFormat"为True时生效
         "targetFormat" : "%Y-%m-%d %H:%M:%S", #目标格式，具体见datetime类格式
         "isEmptyWhenFalse" : True, ##当日期转换失败时，若该项为True，则放置空字符串，若为False，则不改变原值
         "format":[ ##日期格式
 
         ],
         "dateFormat" :[ ##自定义的日期格式器,写于dateFormat.py中, 传入方法名即可
 
         ]
     },
-    "fillColumns": False, ##是否自动填充空行合并单元格造成的空格, 默认为False
-    "fillRows" : False, ##是否自动填充列合并单元格造成的空格, 默认为False
+    # "fillColumns": False, ##是否自动填充空行合并单元格造成的空格, 默认为False
+    # "fillRows" : False, ##是否自动填充列合并单元格造成的空格, 默认为False
+    "setValue" : False, ##设置此区域为某个值
     "setNull" : False, ##设置为空值，此选项具有最高优先级
 
 }
 
 test = excel.copy()
 test["sheet"] = sheet.copy()
 test["sheet"]["mainTitle"] = mainTitle.copy()
```

### Comparing `excel2db-0.0.5/excel2db/demo/generalDemoFile.py` & `excel2db-1.0.0/excel2db/demo/generalDemoFile.py`

 * *Files 22% similar despite different names*

```diff
@@ -402,77 +402,348 @@
 00001910: aee7 9083 225d 2c0d 0a20 2020 2020 2020  ...."],..       
 00001920: 2020 2020 2020 2020 2020 2020 205b 22e6               [".
 00001930: 9d8e e59b 9b22 2c22 e5a5 b322 2c32 312c  .....","...",21,
 00001940: 22e8 b6b3 e790 8322 5d0d 0a20 2020 2020  "......"]..     
 00001950: 2020 2020 2020 2020 2020 205d 0d0a 2020             ]..  
 00001960: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
 00001970: 2020 2020 205d 0d0a 2020 2020 7d2c 0d0a       ]..    },..
-00001980: 7d0d 0a0d 0a66 726f 6d20 6578 6365 6c32  }....from excel2
-00001990: 6462 2e63 6f6d 2e75 7469 6c20 696d 706f  db.com.util impo
-000019a0: 7274 2066 696c 6554 6f6f 6c0d 0a69 6d70  rt fileTool..imp
-000019b0: 6f72 7420 6f70 656e 7079 786c 0d0a 6669  ort openpyxl..fi
-000019c0: 6c65 746f 6f6c 203d 2066 696c 6554 6f6f  letool = fileToo
-000019d0: 6c2e 6669 6c65 546f 6f6c 2829 0d0a 0d0a  l.fileTool()....
-000019e0: 6465 6620 6765 6e65 7261 6c44 656d 6f46  def generalDemoF
-000019f0: 696c 6528 293a 0d0a 2020 2020 666f 7220  ile():..    for 
-00001a00: 6465 6d6f 4e61 6d65 2069 6e20 6465 6d6f  demoName in demo
-00001a10: 3a0d 0a20 2020 2020 2020 2066 696c 6574  :..        filet
-00001a20: 6f6f 6c2e 6372 6561 7465 4469 7228 222e  ool.createDir(".
-00001a30: 2f22 202b 2064 656d 6f4e 616d 652c 206d  /" + demoName, m
-00001a40: 6f64 653d 3129 0d0a 2020 2020 2020 2020  ode=1)..        
-00001a50: 6669 6c65 746f 6f6c 2e77 7269 7465 4f76  filetool.writeOv
-00001a60: 6572 4669 6c65 2822 2e2f 2220 2b20 6465  erFile("./" + de
-00001a70: 6d6f 4e61 6d65 202b 2022 2f5f 5f69 6e69  moName + "/__ini
-00001a80: 745f 5f2e 7079 222c 2022 2229 0d0a 2020  t__.py", "")..  
-00001a90: 2020 2020 2020 6669 6c65 746f 6f6c 2e77        filetool.w
-00001aa0: 7269 7465 4f76 6572 4669 6c65 2822 2e2f  riteOverFile("./
-00001ab0: 2220 2b20 6465 6d6f 4e61 6d65 202b 2022  " + demoName + "
-00001ac0: 2f22 202b 2064 656d 6f4e 616d 6520 2b20  /" + demoName + 
-00001ad0: 222e 7079 222c 2064 656d 6f5b 6465 6d6f  ".py", demo[demo
-00001ae0: 4e61 6d65 5d5b 2266 696c 6522 5d29 0d0a  Name]["file"])..
-00001af0: 2020 2020 2020 2020 6669 6c65 746f 6f6c          filetool
-00001b00: 2e77 7269 7465 4f76 6572 4669 6c65 2822  .writeOverFile("
-00001b10: 2e2f 2220 2b20 6465 6d6f 4e61 6d65 202b  ./" + demoName +
-00001b20: 2022 2f22 202b 2064 656d 6f4e 616d 6520   "/" + demoName 
-00001b30: 2b20 222e 6a73 6f6e 222c 2064 656d 6f5b  + ".json", demo[
-00001b40: 6465 6d6f 4e61 6d65 5d5b 226a 736f 6e22  demoName]["json"
-00001b50: 5d29 0d0a 0d0a 2020 2020 2020 2020 2320  ])....        # 
-00001b60: e794 9fe6 8890 e4b8 80e4 b8aa 2057 6f72  ............ Wor
-00001b70: 6b62 6f6f 6b20 e79a 84e5 ae9e e4be 8be5  kbook ..........
-00001b80: 8c96 e5af b9e8 b1a1 efbc 8c77 62e5 8db3  ...........wb...
-00001b90: e4bb a3e8 a1a8 e4b8 80e4 b8aa e5b7 a5e4  ................
-00001ba0: bd9c e7b0 bfef bc88 e4b8 80e4 b8aa 2045  .............. E
-00001bb0: 7863 656c 20e6 9687 e4bb b6ef bc89 0d0a  xcel ...........
-00001bc0: 2020 2020 2020 2020 7762 203d 206f 7065          wb = ope
-00001bd0: 6e70 7978 6c2e 576f 726b 626f 6f6b 2829  npyxl.Workbook()
-00001be0: 0d0a 2020 2020 2020 2020 696e 6465 7820  ..        index 
-00001bf0: 3d20 310d 0a20 2020 2020 2020 2066 6f72  = 1..        for
-00001c00: 2073 6865 6574 2069 6e20 6465 6d6f 5b64   sheet in demo[d
-00001c10: 656d 6f4e 616d 655d 5b22 6578 6365 6c22  emoName]["excel"
-00001c20: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-00001c30: 6966 2069 6e64 6578 3d3d 313a 0d0a 2020  if index==1:..  
-00001c40: 2020 2020 2020 2020 2020 2020 2020 7773                ws
-00001c50: 3d77 622e 6163 7469 7665 0d0a 2020 2020  =wb.active..    
-00001c60: 2020 2020 2020 2020 2020 2020 7773 2e74              ws.t
-00001c70: 6974 6c65 203d 2073 6865 6574 5b22 7368  itle = sheet["sh
-00001c80: 6565 744e 616d 6522 5d0d 0a20 2020 2020  eetName"]..     
-00001c90: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00001ca0: 2020 2020 2020 2020 2020 2020 2020 7762                wb
-00001cb0: 2e63 7265 6174 655f 7368 6565 7428 7368  .create_sheet(sh
-00001cc0: 6565 745b 2273 6865 6574 4e61 6d65 225d  eet["sheetName"]
-00001cd0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00001ce0: 2020 2077 7320 3d20 7762 5b73 6865 6574     ws = wb[sheet
-00001cf0: 5b22 7368 6565 744e 616d 6522 5d5d 0d0a  ["sheetName"]]..
-00001d00: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-00001d10: 6465 7820 2b3d 2031 0d0a 0d0a 2020 2020  dex += 1....    
-00001d20: 2020 2020 2020 2020 666f 7220 726f 7720          for row 
-00001d30: 696e 2073 6865 6574 5b22 6461 7461 225d  in sheet["data"]
-00001d40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00001d50: 2020 2077 732e 6170 7065 6e64 2872 6f77     ws.append(row
-00001d60: 290d 0a0d 0a20 2020 2020 2020 2077 622e  )....        wb.
-00001d70: 7361 7665 2822 2e2f 2220 2b20 6465 6d6f  save("./" + demo
-00001d80: 4e61 6d65 202b 2022 2f22 202b 2064 656d  Name + "/" + dem
-00001d90: 6f4e 616d 6520 2b20 222e 786c 7378 2229  oName + ".xlsx")
-00001da0: 0d0a 0d0a 6966 205f 5f6e 616d 655f 5f20  ....if __name__ 
-00001db0: 3d3d 2022 5f5f 6d61 696e 5f5f 223a 0d0a  == "__main__":..
-00001dc0: 2020 2020 6765 6e65 7261 6c44 656d 6f46      generalDemoF
-00001dd0: 696c 6528 29                             ile()
+00001980: 2020 2020 2264 656d 6f38 223a 7b0d 0a20      "demo8":{.. 
+00001990: 2020 2020 2020 2022 6669 6c65 223a 2222         "file":""
+000019a0: 220d 0a5c 225c 225c 220d 0ae6 af8f e4b8  "..\"\"\".......
+000019b0: 89e8 a18c e58f aae8 8eb7 e58f 96e4 b880  ................
+000019c0: e8a1 8ce6 bc94 e7a4 ba0d 0a5c 225c 225c  ...........\"\"\
+000019d0: 220d 0a66 726f 6d20 6578 6365 6c32 6462  "..from excel2db
+000019e0: 2e65 7863 656c 3264 6220 696d 706f 7274  .excel2db import
+000019f0: 2065 7863 656c 3264 620d 0a0d 0a69 6620   excel2db....if 
+00001a00: 5f5f 6e61 6d65 5f5f 203d 3d20 225f 5f6d  __name__ == "__m
+00001a10: 6169 6e5f 5f22 3a0d 0a20 2020 2065 7863  ain__":..    exc
+00001a20: 656c 5572 6c20 3d20 222e 2f64 656d 6f38  elUrl = "./demo8
+00001a30: 2e78 6c73 7822 0d0a 2020 2020 6564 203d  .xlsx"..    ed =
+00001a40: 2065 7863 656c 3264 6228 222e 2f64 656d   excel2db("./dem
+00001a50: 6f38 2e6a 736f 6e22 290d 0a20 2020 2065  o8.json")..    e
+00001a60: 642e 6578 6365 6c32 6462 2865 7863 656c  d.excel2db(excel
+00001a70: 5572 6c29 0d0a 2020 2020 6564 2e76 616c  Url)..    ed.val
+00001a80: 7565 2e64 6243 6f6e 6e65 6374 2e63 6c6f  ue.dbConnect.clo
+00001a90: 7365 2829 0d0a 2020 2020 2020 2020 2222  se()..        ""
+00001aa0: 222c 0d0a 2020 2020 2020 2020 226a 736f  ",..        "jso
+00001ab0: 6e22 3a22 2222 0d0a 7b0d 0a20 2022 7368  n":"""..{..  "sh
+00001ac0: 6565 7422 203a 205b 0d0a 2020 2020 7b0d  eet" : [..    {.
+00001ad0: 0a20 2020 2020 2022 7368 6565 7449 4422  .      "sheetID"
+00001ae0: 203a 2030 2c0d 0a20 2020 2020 2022 6d61   : 0,..      "ma
+00001af0: 696e 4461 7461 2220 3a20 7b0d 0a20 2020  inData" : {..   
+00001b00: 2020 2020 2022 6d61 696e 4461 7461 526f       "mainDataRo
+00001b10: 7773 2220 3a20 5b22 726f 7725 323d 3d31  ws" : ["row%2==1
+00001b20: 225d 0d0a 2020 2020 2020 7d0d 0a20 2020  "]..      }..   
+00001b30: 207d 0d0a 2020 5d0d 0a7d 0d0a 2020 2020   }..  ]..}..    
+00001b40: 2020 2020 2222 222c 0d0a 2020 2020 2020      """,..      
+00001b50: 2020 2265 7863 656c 223a 5b0d 0a20 2020    "excel":[..   
+00001b60: 2020 2020 2020 2020 207b 0d0a 2020 2020           {..    
+00001b70: 2020 2020 2020 2020 2020 2020 2273 6865              "she
+00001b80: 6574 4e61 6d65 223a 2273 7431 222c 0d0a  etName":"st1",..
+00001b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ba0: 2264 6174 6122 3a5b 0d0a 2020 2020 2020  "data":[..      
+00001bb0: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
+00001bc0: e8a1 8ce6 95b0 225d 2c0d 0a20 2020 2020  ......"],..     
+00001bd0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00001be0: 22e7 acac e4b8 80e8 a18c 225d 2c0d 0a20  "........."],.. 
+00001bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001c00: 2020 205b 22e7 acac e4ba 8ce8 a18c 225d     ["........."]
+00001c10: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00001c20: 2020 2020 2020 205b 22e7 acac e4b8 89e8         [".......
+00001c30: a18c 225d 2c0d 0a20 2020 2020 2020 2020  .."],..         
+00001c40: 2020 2020 2020 2020 2020 205b 22e7 acac             ["...
+00001c50: e59b 9be8 a18c 225d 2c0d 0a20 2020 2020  ......"],..     
+00001c60: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00001c70: 22e7 acac e4ba 94e8 a18c 225d 2c0d 0a20  "........."],.. 
+00001c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001c90: 2020 205b 22e7 acac e585 ade8 a18c 225d     ["........."]
+00001ca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001cb0: 2020 5d0d 0a20 2020 2020 2020 2020 2020    ]..           
+00001cc0: 207d 0d0a 2020 2020 2020 2020 5d0d 0a20   }..        ].. 
+00001cd0: 2020 207d 2c0d 0a20 2020 2022 6465 6d6f     },..    "demo
+00001ce0: 3922 3a7b 0d0a 2020 2020 2020 2020 2266  9":{..        "f
+00001cf0: 696c 6522 3a22 2222 0d0a 5c22 5c22 5c22  ile":"""..\"\"\"
+00001d00: 0d0a e4bb bbe6 848f e88c 83e5 9bb4 e8b0  ................
+00001d10: 83e6 95b4 e6bc 94e7 a4ba 0d0a 5c22 5c22  ............\"\"
+00001d20: 5c22 0d0a 6672 6f6d 2065 7863 656c 3264  \"..from excel2d
+00001d30: 622e 6578 6365 6c32 6462 2069 6d70 6f72  b.excel2db impor
+00001d40: 7420 6578 6365 6c32 6462 0d0a 0d0a 6966  t excel2db....if
+00001d50: 205f 5f6e 616d 655f 5f20 3d3d 2022 5f5f   __name__ == "__
+00001d60: 6d61 696e 5f5f 223a 0d0a 2020 2020 6578  main__":..    ex
+00001d70: 6365 6c55 726c 203d 2022 2e2f 6465 6d6f  celUrl = "./demo
+00001d80: 392e 786c 7378 220d 0a20 2020 2065 6420  9.xlsx"..    ed 
+00001d90: 3d20 6578 6365 6c32 6462 2822 2e2f 6465  = excel2db("./de
+00001da0: 6d6f 392e 6a73 6f6e 2229 0d0a 2020 2020  mo9.json")..    
+00001db0: 6564 2e65 7863 656c 3264 6228 6578 6365  ed.excel2db(exce
+00001dc0: 6c55 726c 290d 0a20 2020 2065 642e 7661  lUrl)..    ed.va
+00001dd0: 6c75 652e 6462 436f 6e6e 6563 742e 636c  lue.dbConnect.cl
+00001de0: 6f73 6528 290d 0a20 2020 2020 2020 2022  ose()..        "
+00001df0: 2222 2c0d 0a20 2020 2020 2020 2022 6a73  "",..        "js
+00001e00: 6f6e 223a 2222 220d 0a7b 0d0a 2020 2273  on":"""..{..  "s
+00001e10: 6865 6574 2220 3a20 5b0d 0a20 2020 207b  heet" : [..    {
+00001e20: 0d0a 2020 2020 2020 2273 6865 6574 4944  ..      "sheetID
+00001e30: 2220 3a20 302c 0d0a 2020 2020 2020 226d  " : 0,..      "m
+00001e40: 6169 6e44 6174 6122 203a 207b 0d0a 2020  ainData" : {..  
+00001e50: 2020 2020 2020 2273 6361 6c65 4c69 7374        "scaleList
+00001e60: 2220 3a20 5b0d 0a20 2020 2020 2020 2020  " : [..         
+00001e70: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
+00001e80: 2273 7461 7274 2220 3a20 2243 2b32 222c  "start" : "C+2",
+00001e90: 0d0a 2020 2020 2020 2020 2020 2020 2263  ..            "c
+00001ea0: 6f6c 756d 6e73 2220 3a20 312c 0d0a 2020  olumns" : 1,..  
+00001eb0: 2020 2020 2020 2020 2020 2272 6570 6c61            "repla
+00001ec0: 6365 416c 6c22 203a 205b 0d0a 2020 2020  ceAll" : [..    
+00001ed0: 2020 2020 2020 2020 2020 7b0d 0a20 2020            {..   
+00001ee0: 2020 2020 2020 2020 2020 2020 2022 696e               "in
+00001ef0: 6944 6174 6122 203a 2035 362c 0d0a 2020  iData" : 56,..  
+00001f00: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00001f10: 6174 6122 203a 2033 340d 0a20 2020 2020  ata" : 34..     
+00001f20: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
+00001f30: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
+00001f40: 2020 2020 207d 2c7b 0d0a 2020 2020 2020       },{..      
+00001f50: 2020 2020 2020 2273 7461 7274 2220 3a20        "start" : 
+00001f60: 2244 2b32 222c 0d0a 2020 2020 2020 2020  "D+2",..        
+00001f70: 2020 2020 2263 6f6c 756d 6e73 2220 3a20      "columns" : 
+00001f80: 312c 0d0a 2020 2020 2020 2020 2020 2020  1,..            
+00001f90: 2272 6570 6c61 6365 536f 6d65 2220 3a20  "replaceSome" : 
+00001fa0: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
+00001fb0: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
+00001fc0: 2020 2020 2269 6e69 4461 7461 2220 3a20      "iniData" : 
+00001fd0: 362c 0d0a 2020 2020 2020 2020 2020 2020  6,..            
+00001fe0: 2020 2020 2264 6174 6122 203a 2034 0d0a      "data" : 4..
+00001ff0: 2020 2020 2020 2020 2020 2020 2020 7d0d                }.
+00002000: 0a20 2020 2020 2020 2020 2020 205d 0d0a  .            ]..
+00002010: 2020 2020 2020 2020 2020 7d2c 7b0d 0a20            },{.. 
+00002020: 2020 2020 2020 2020 2020 2022 7374 6172             "star
+00002030: 7422 203a 2022 452b 3222 2c0d 0a20 2020  t" : "E+2",..   
+00002040: 2020 2020 2020 2020 2022 636f 6c75 6d6e           "column
+00002050: 7322 203a 2031 2c0d 0a20 2020 2020 2020  s" : 1,..       
+00002060: 2020 2020 2022 7365 744e 756c 6c22 203a       "setNull" :
+00002070: 2074 7275 650d 0a20 2020 2020 2020 2020   true..         
+00002080: 207d 2c7b 0d0a 2020 2020 2020 2020 2020   },{..          
+00002090: 2020 2273 7461 7274 2220 3a20 2246 2b32    "start" : "F+2
+000020a0: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
+000020b0: 2263 6f6c 756d 6e73 2220 3a20 312c 0d0a  "columns" : 1,..
+000020c0: 2020 2020 2020 2020 2020 2020 2273 6574              "set
+000020d0: 5661 6c75 6522 203a 2037 370d 0a20 2020  Value" : 77..   
+000020e0: 2020 2020 2020 207d 0d0a 2020 2020 2020         }..      
+000020f0: 2020 5d0d 0a20 2020 2020 207d 0d0a 2020    ]..      }..  
+00002100: 2020 7d0d 0a20 205d 0d0a 7d0d 0a20 2020    }..  ]..}..   
+00002110: 2020 2020 2022 2222 2c0d 0a20 2020 2020       """,..     
+00002120: 2020 2022 6578 6365 6c22 3a5b 0d0a 2020     "excel":[..  
+00002130: 2020 2020 2020 2020 2020 7b0d 0a20 2020            {..   
+00002140: 2020 2020 2020 2020 2020 2020 2022 7368               "sh
+00002150: 6565 744e 616d 6522 3a22 7374 3122 2c0d  eetName":"st1",.
+00002160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002170: 2022 6461 7461 223a 5b0d 0a20 2020 2020   "data":[..     
+00002180: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00002190: 22e5 a793 e590 8d22 2c22 e680 a7e5 88ab  "......","......
+000021a0: 222c 22e8 afad e696 8722 2c22 e695 b0e5  ","......","....
+000021b0: ada6 222c 22e8 8bb1 e8af ad22 2c22 e58e  ..","......","..
+000021c0: 86e5 8fb2 225d 2c0d 0a20 2020 2020 2020  ...."],..       
+000021d0: 2020 2020 2020 2020 2020 2020 205b 22e5               [".
+000021e0: bca0 e4b8 8922 2c22 e794 b722 2c35 362c  .....","...",56,
+000021f0: 3637 2c37 362c 3536 5d2c 0d0a 2020 2020  67,76,56],..    
+00002200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002210: 5b22 e69d 8ee5 9b9b 222c 22e5 a5b3 222c  ["......","...",
+00002220: 3435 3635 2c33 362c 3534 2c38 395d 0d0a  4565,36,54,89]..
+00002230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002240: 5d0d 0a20 2020 2020 2020 2020 2020 207d  ]..            }
+00002250: 0d0a 2020 2020 2020 2020 5d0d 0a20 2020  ..        ]..   
+00002260: 207d 2c0d 0a20 2020 2022 6465 6d6f 3130   },..    "demo10
+00002270: 223a 7b0d 0a20 2020 2020 2020 2022 6669  ":{..        "fi
+00002280: 6c65 223a 2222 220d 0a5c 225c 225c 220d  le":"""..\"\"\".
+00002290: 0ae6 97a5 e69c 9fe6 a0bc e5bc 8fe5 8c96  ................
+000022a0: e6bc 94e7 a4ba 0d0a 5c22 5c22 5c22 0d0a  ........\"\"\"..
+000022b0: 6672 6f6d 2065 7863 656c 3264 622e 6578  from excel2db.ex
+000022c0: 6365 6c32 6462 2069 6d70 6f72 7420 6578  cel2db import ex
+000022d0: 6365 6c32 6462 0d0a 6672 6f6d 2065 7863  cel2db..from exc
+000022e0: 656c 3264 622e 636f 6d2e 7574 696c 2069  el2db.com.util i
+000022f0: 6d70 6f72 7420 7469 6d65 546f 6f6c 0d0a  mport timeTool..
+00002300: 0d0a 6465 6620 6461 7465 466f 726d 6174  ..def dateFormat
+00002310: 5f31 2864 6174 652c 2074 6172 6765 7446  _1(date, targetF
+00002320: 6f72 6d61 7429 3a0d 0a20 2020 205c 225c  ormat):..    \"\
+00002330: 225c 220d 0a20 2020 20e8 87aa e5ae 9ae4  "\"..    .......
+00002340: b989 e697 a5e6 9c9f e6a0 bce5 bc8f e58c  ................
+00002350: 96e6 96b9 e6b3 950d 0a20 2020 203a 7061  .........    :pa
+00002360: 7261 6d20 6461 7465 3a20 e4bc a0e5 85a5  ram date: ......
+00002370: e697 a5e6 9c9f 0d0a 2020 2020 3a70 6172  ........    :par
+00002380: 616d 2074 6172 6765 7446 6f72 6d61 743a  am targetFormat:
+00002390: e79b aee6 a087 e6a0 bce5 bc8f 0d0a 2020  ..............  
+000023a0: 2020 3a72 6574 7572 6e3a 20e8 bf94 e59b    :return: .....
+000023b0: 9ee6 97a5 e69c 9f0d 0a20 2020 205c 225c  .........    \"\
+000023c0: 225c 220d 0a20 2020 2062 6173 6544 6174  "\"..    baseDat
+000023d0: 6520 3d20 2232 3032 332d 3038 2d30 3122  e = "2023-08-01"
+000023e0: 2020 2323 e59f bae5 8786 e697 a5e6 9c9f    ##............
+000023f0: 0d0a 2020 2020 6261 7365 4e75 6d20 3d20  ..    baseNum = 
+00002400: 3435 3133 3920 2023 23e5 9fba e587 86e6  45139  ##.......
+00002410: 95b0 e5ad 970d 0a20 2020 206e 756d 6265  .......    numbe
+00002420: 7220 3d20 696e 7428 666c 6f61 7428 6461  r = int(float(da
+00002430: 7465 2929 0d0a 2020 2020 6461 7465 203d  te))..    date =
+00002440: 2074 696d 6554 6f6f 6c2e 6368 616e 6765   timeTool.change
+00002450: 5469 6d65 2862 6173 6544 6174 652c 2022  Time(baseDate, "
+00002460: 6461 7973 222c 206e 756d 6265 7220 2d20  days", number - 
+00002470: 6261 7365 4e75 6d2c 2074 6172 6765 7446  baseNum, targetF
+00002480: 6f72 6d61 7429 0d0a 0d0a 2020 2020 7265  ormat)....    re
+00002490: 7475 726e 2064 6174 650d 0a0d 0a69 6620  turn date....if 
+000024a0: 5f5f 6e61 6d65 5f5f 203d 3d20 225f 5f6d  __name__ == "__m
+000024b0: 6169 6e5f 5f22 3a0d 0a20 2020 2065 7863  ain__":..    exc
+000024c0: 656c 5572 6c20 3d20 222e 2f64 656d 6f31  elUrl = "./demo1
+000024d0: 302e 786c 7378 220d 0a20 2020 2065 6420  0.xlsx"..    ed 
+000024e0: 3d20 6578 6365 6c32 6462 2822 2e2f 6465  = excel2db("./de
+000024f0: 6d6f 3130 2e6a 736f 6e22 290d 0a20 2020  mo10.json")..   
+00002500: 2065 642e 7365 7444 6174 6546 6f72 6d61   ed.setDateForma
+00002510: 7446 756e 6328 6461 7465 466f 726d 6174  tFunc(dateFormat
+00002520: 5f31 290d 0a20 2020 2065 642e 6578 6365  _1)..    ed.exce
+00002530: 6c32 6462 2865 7863 656c 5572 6c29 0d0a  l2db(excelUrl)..
+00002540: 2020 2020 6564 2e76 616c 7565 2e64 6243      ed.value.dbC
+00002550: 6f6e 6e65 6374 2e63 6c6f 7365 2829 0d0a  onnect.close()..
+00002560: 2020 2020 2020 2020 2222 222c 0d0a 2020          """,..  
+00002570: 2020 2020 2020 226a 736f 6e22 3a22 2222        "json":"""
+00002580: 0d0a 7b0d 0a20 2022 7368 6565 7422 203a  ..{..  "sheet" :
+00002590: 205b 0d0a 2020 2020 7b0d 0a20 2020 2020   [..    {..     
+000025a0: 2022 7368 6565 7449 4422 203a 2030 2c0d   "sheetID" : 0,.
+000025b0: 0a20 2020 2020 2022 6d61 696e 4461 7461  .      "mainData
+000025c0: 2220 3a20 7b0d 0a20 2020 2020 2020 2022  " : {..        "
+000025d0: 7363 616c 654c 6973 7422 203a 205b 0d0a  scaleList" : [..
+000025e0: 2020 2020 2020 2020 2020 7b0d 0a20 2020            {..   
+000025f0: 2020 2020 2020 2020 2022 7374 6172 7422           "start"
+00002600: 203a 2022 412b 3222 2c0d 0a20 2020 2020   : "A+2",..     
+00002610: 2020 2020 2020 2022 636f 6c75 6d6e 7322         "columns"
+00002620: 203a 2031 2c0d 0a20 2020 2020 2020 2020   : 1,..         
+00002630: 2020 2022 6973 4461 7465 466f 726d 6174     "isDateFormat
+00002640: 2220 3a20 7472 7565 2c0d 0a20 2020 2020  " : true,..     
+00002650: 2020 2020 2020 2022 6461 7465 466f 726d         "dateForm
+00002660: 6174 2220 3a20 7b0d 0a20 2020 2020 2020  at" : {..       
+00002670: 2020 2020 2020 2022 666f 726d 6174 223a         "format":
+00002680: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
+00002690: 2020 2022 2559 2f25 6d2f 2564 220d 0a20     "%Y/%m/%d".. 
+000026a0: 2020 2020 2020 2020 2020 2020 205d 0d0a               ]..
+000026b0: 2020 2020 2020 2020 2020 2020 7d0d 0a20              }.. 
+000026c0: 2020 2020 2020 2020 207d 2c7b 0d0a 2020           },{..  
+000026d0: 2020 2020 2020 2020 2020 2273 7461 7274            "start
+000026e0: 2220 3a20 2242 2b32 222c 0d0a 2020 2020  " : "B+2",..    
+000026f0: 2020 2020 2020 2020 2263 6f6c 756d 6e73          "columns
+00002700: 2220 3a20 312c 0d0a 2020 2020 2020 2020  " : 1,..        
+00002710: 2020 2020 2269 7344 6174 6546 6f72 6d61      "isDateForma
+00002720: 7422 203a 2074 7275 652c 0d0a 2020 2020  t" : true,..    
+00002730: 2020 2020 2020 2020 2264 6174 6546 6f72          "dateFor
+00002740: 6d61 7422 203a 207b 0d0a 2020 2020 2020  mat" : {..      
+00002750: 2020 2020 2020 2020 2274 6172 6765 7446          "targetF
+00002760: 6f72 6d61 7422 203a 2022 2559 2d25 6d2d  ormat" : "%Y-%m-
+00002770: 2564 222c 0d0a 2020 2020 2020 2020 2020  %d",..          
+00002780: 2020 2020 2266 6f72 6d61 7422 3a5b 0d0a      "format":[..
+00002790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000027a0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
+000027b0: 2553 220d 0a20 2020 2020 2020 2020 2020  %S"..           
+000027c0: 2020 205d 0d0a 2020 2020 2020 2020 2020     ]..          
+000027d0: 2020 7d0d 0a20 2020 2020 2020 2020 207d    }..          }
+000027e0: 2c7b 0d0a 2020 2020 2020 2020 2020 2020  ,{..            
+000027f0: 2273 7461 7274 2220 3a20 2243 2b32 222c  "start" : "C+2",
+00002800: 0d0a 2020 2020 2020 2020 2020 2020 2263  ..            "c
+00002810: 6f6c 756d 6e73 2220 3a20 312c 0d0a 2020  olumns" : 1,..  
+00002820: 2020 2020 2020 2020 2020 2269 7344 6174            "isDat
+00002830: 6546 6f72 6d61 7422 203a 2074 7275 652c  eFormat" : true,
+00002840: 0d0a 2020 2020 2020 2020 2020 2020 2264  ..            "d
+00002850: 6174 6546 6f72 6d61 7422 203a 207b 0d0a  ateFormat" : {..
+00002860: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00002870: 6172 6765 7446 6f72 6d61 7422 203a 2022  argetFormat" : "
+00002880: 2559 2d25 6d2d 2564 222c 0d0a 2020 2020  %Y-%m-%d",..    
+00002890: 2020 2020 2020 2020 2020 2264 6174 6546            "dateF
+000028a0: 6f72 6d61 7422 203a 205b 0d0a 2020 2020  ormat" : [..    
+000028b0: 2020 2020 2020 2020 2020 2020 2264 6174              "dat
+000028c0: 6546 6f72 6d61 745f 3122 0d0a 2020 2020  eFormat_1"..    
+000028d0: 2020 2020 2020 2020 2020 5d0d 0a20 2020            ]..   
+000028e0: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
+000028f0: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
+00002900: 205d 0d0a 2020 2020 2020 7d0d 0a20 2020   ]..      }..   
+00002910: 207d 0d0a 2020 5d0d 0a7d 0d0a 2020 2020   }..  ]..}..    
+00002920: 2020 2020 2222 222c 0d0a 2020 2020 2020      """,..      
+00002930: 2020 2265 7863 656c 223a 5b0d 0a20 2020    "excel":[..   
+00002940: 2020 2020 2020 2020 207b 0d0a 2020 2020           {..    
+00002950: 2020 2020 2020 2020 2020 2020 2273 6865              "she
+00002960: 6574 4e61 6d65 223a 2273 7431 222c 0d0a  etName":"st1",..
+00002970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002980: 2264 6174 6122 3a5b 0d0a 2020 2020 2020  "data":[..      
+00002990: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
+000029a0: e697 a5e6 9c9f 3122 2c22 e697 a5e6 9c9f  ......1","......
+000029b0: 3222 2c22 e697 a5e6 9c9f 3322 5d2c 0d0a  2","......3"],..
+000029c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000029d0: 2020 2020 5b22 3230 3234 2f31 2f32 222c      ["2024/1/2",
+000029e0: 2232 3032 342d 3033 2d30 3120 3031 3a32  "2024-03-01 01:2
+000029f0: 333a 3333 222c 3435 3133 395d 2c0d 0a20  3:33",45139],.. 
+00002a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a10: 2020 205b 2232 3032 332f 352f 3236 222c     ["2023/5/26",
+00002a20: 2232 3032 332d 3032 2d31 3120 3035 3a35  "2023-02-11 05:5
+00002a30: 363a 3334 222c 3435 3135 365d 0d0a 2020  6:34",45156]..  
+00002a40: 2020 2020 2020 2020 2020 2020 2020 5d0d                ].
+00002a50: 0a20 2020 2020 2020 2020 2020 207d 0d0a  .            }..
+00002a60: 2020 2020 2020 2020 5d0d 0a20 2020 207d          ]..    }
+00002a70: 2c0d 0a7d 0d0a 0d0a 6672 6f6d 2065 7863  ,..}....from exc
+00002a80: 656c 3264 622e 636f 6d2e 7574 696c 2069  el2db.com.util i
+00002a90: 6d70 6f72 7420 6669 6c65 546f 6f6c 0d0a  mport fileTool..
+00002aa0: 696d 706f 7274 206f 7065 6e70 7978 6c0d  import openpyxl.
+00002ab0: 0a66 696c 6574 6f6f 6c20 3d20 6669 6c65  .filetool = file
+00002ac0: 546f 6f6c 2e66 696c 6554 6f6f 6c28 290d  Tool.fileTool().
+00002ad0: 0a0d 0a64 6566 2067 656e 6572 616c 4465  ...def generalDe
+00002ae0: 6d6f 4669 6c65 2829 3a0d 0a20 2020 2066  moFile():..    f
+00002af0: 6f72 2064 656d 6f4e 616d 6520 696e 2064  or demoName in d
+00002b00: 656d 6f3a 0d0a 2020 2020 2020 2020 6669  emo:..        fi
+00002b10: 6c65 746f 6f6c 2e63 7265 6174 6544 6972  letool.createDir
+00002b20: 2822 2e2f 2220 2b20 6465 6d6f 4e61 6d65  ("./" + demoName
+00002b30: 2c20 6d6f 6465 3d31 290d 0a20 2020 2020  , mode=1)..     
+00002b40: 2020 2066 696c 6574 6f6f 6c2e 7772 6974     filetool.writ
+00002b50: 654f 7665 7246 696c 6528 222e 2f22 202b  eOverFile("./" +
+00002b60: 2064 656d 6f4e 616d 6520 2b20 222f 5f5f   demoName + "/__
+00002b70: 696e 6974 5f5f 2e70 7922 2c20 2222 290d  init__.py", "").
+00002b80: 0a20 2020 2020 2020 2066 696c 6574 6f6f  .        filetoo
+00002b90: 6c2e 7772 6974 654f 7665 7246 696c 6528  l.writeOverFile(
+00002ba0: 222e 2f22 202b 2064 656d 6f4e 616d 6520  "./" + demoName 
+00002bb0: 2b20 222f 2220 2b20 6465 6d6f 4e61 6d65  + "/" + demoName
+00002bc0: 202b 2022 2e70 7922 2c20 6465 6d6f 5b64   + ".py", demo[d
+00002bd0: 656d 6f4e 616d 655d 5b22 6669 6c65 225d  emoName]["file"]
+00002be0: 290d 0a20 2020 2020 2020 2066 696c 6574  )..        filet
+00002bf0: 6f6f 6c2e 7772 6974 654f 7665 7246 696c  ool.writeOverFil
+00002c00: 6528 222e 2f22 202b 2064 656d 6f4e 616d  e("./" + demoNam
+00002c10: 6520 2b20 222f 2220 2b20 6465 6d6f 4e61  e + "/" + demoNa
+00002c20: 6d65 202b 2022 2e6a 736f 6e22 2c20 6465  me + ".json", de
+00002c30: 6d6f 5b64 656d 6f4e 616d 655d 5b22 6a73  mo[demoName]["js
+00002c40: 6f6e 225d 290d 0a0d 0a20 2020 2020 2020  on"])....       
+00002c50: 2023 20e7 949f e688 90e4 b880 e4b8 aa20   # ............ 
+00002c60: 576f 726b 626f 6f6b 20e7 9a84 e5ae 9ee4  Workbook .......
+00002c70: be8b e58c 96e5 afb9 e8b1 a1ef bc8c 7762  ..............wb
+00002c80: e58d b3e4 bba3 e8a1 a8e4 b880 e4b8 aae5  ................
+00002c90: b7a5 e4bd 9ce7 b0bf efbc 88e4 b880 e4b8  ................
+00002ca0: aa20 4578 6365 6c20 e696 87e4 bbb6 efbc  . Excel ........
+00002cb0: 890d 0a20 2020 2020 2020 2077 6220 3d20  ...        wb = 
+00002cc0: 6f70 656e 7079 786c 2e57 6f72 6b62 6f6f  openpyxl.Workboo
+00002cd0: 6b28 290d 0a20 2020 2020 2020 2069 6e64  k()..        ind
+00002ce0: 6578 203d 2031 0d0a 2020 2020 2020 2020  ex = 1..        
+00002cf0: 666f 7220 7368 6565 7420 696e 2064 656d  for sheet in dem
+00002d00: 6f5b 6465 6d6f 4e61 6d65 5d5b 2265 7863  o[demoName]["exc
+00002d10: 656c 225d 3a0d 0a20 2020 2020 2020 2020  el"]:..         
+00002d20: 2020 2069 6620 696e 6465 783d 3d31 3a0d     if index==1:.
+00002d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002d40: 2077 733d 7762 2e61 6374 6976 650d 0a20   ws=wb.active.. 
+00002d50: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00002d60: 732e 7469 746c 6520 3d20 7368 6565 745b  s.title = sheet[
+00002d70: 2273 6865 6574 4e61 6d65 225d 0d0a 2020  "sheetName"]..  
+00002d80: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00002d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002da0: 2077 622e 6372 6561 7465 5f73 6865 6574   wb.create_sheet
+00002db0: 2873 6865 6574 5b22 7368 6565 744e 616d  (sheet["sheetNam
+00002dc0: 6522 5d29 0d0a 2020 2020 2020 2020 2020  e"])..          
+00002dd0: 2020 2020 2020 7773 203d 2077 625b 7368        ws = wb[sh
+00002de0: 6565 745b 2273 6865 6574 4e61 6d65 225d  eet["sheetName"]
+00002df0: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
+00002e00: 2069 6e64 6578 202b 3d20 310d 0a0d 0a20   index += 1.... 
+00002e10: 2020 2020 2020 2020 2020 2066 6f72 2072             for r
+00002e20: 6f77 2069 6e20 7368 6565 745b 2264 6174  ow in sheet["dat
+00002e30: 6122 5d3a 0d0a 2020 2020 2020 2020 2020  a"]:..          
+00002e40: 2020 2020 2020 7773 2e61 7070 656e 6428        ws.append(
+00002e50: 726f 7729 0d0a 0d0a 2020 2020 2020 2020  row)....        
+00002e60: 7762 2e73 6176 6528 222e 2f22 202b 2064  wb.save("./" + d
+00002e70: 656d 6f4e 616d 6520 2b20 222f 2220 2b20  emoName + "/" + 
+00002e80: 6465 6d6f 4e61 6d65 202b 2022 2e78 6c73  demoName + ".xls
+00002e90: 7822 290d 0a0d 0a69 6620 5f5f 6e61 6d65  x")....if __name
+00002ea0: 5f5f 203d 3d20 225f 5f6d 6169 6e5f 5f22  __ == "__main__"
+00002eb0: 3a0d 0a20 2020 2067 656e 6572 616c 4465  :..    generalDe
+00002ec0: 6d6f 4669 6c65 2829                      moFile()
```

### Comparing `excel2db-0.0.5/excel2db/detailData.py` & `excel2db-1.0.0/excel2db/detailData.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/detailTitle.py` & `excel2db-1.0.0/excel2db/detailTitle.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/excel.py` & `excel2db-1.0.0/excel2db/excel.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/excel2db.py` & `excel2db-1.0.0/excel2db/excel2db.py`

 * *Files 20% similar despite different names*

```diff
@@ -15,8 +15,15 @@
         """
         self.value = value.value() ##生成变量文件
         self.value.rawConf = cheakConf.combinExcelConf(*configFileUrl) ##生成配置文件
 
     def excel2db(self, excelUrl):
         ##执行excel级别转换
         excelManager = excel.excel(self.value, self.value.rawConf)
-        excelManager.excel(excelUrl)
+        excelManager.excel(excelUrl)
+
+    def setDateFormatFunc(self, *dateFormat):
+        """
+        设置日期格式化方法
+        """
+        for func in dateFormat:
+            self.value.dateFormatFunc[func.__name__] = func
```

### Comparing `excel2db-0.0.5/excel2db/insert2sqlite.py` & `excel2db-1.0.0/excel2db/insert2sqlite.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/mainData.py` & `excel2db-1.0.0/excel2db/mainData.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/mainTitle.py` & `excel2db-1.0.0/excel2db/mainTitle.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/scale.py` & `excel2db-1.0.0/excel2db/scale.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,11 +1,13 @@
 # -*- coding:utf8 -*-
 """
 ##执行scale级别转换
 """
+import traceback
+
 from . import cheakConf
 from .com.util import timeTool
 import numpy as np
 
 class scale:
     def __init__(self, value, conf):
 
@@ -22,54 +24,67 @@
         scaleCoordinate = self.value.scaleConf["coordinate"]
 
         ##判断scale是否存在
         if scaleCoordinate.STATUS:  ##若不存在
             return None
 
         if self.value.scaleConf["setNull"]:
-            self.setNull(scaleCoordinate)
+            self.setValue(scaleCoordinate, np.nan)
             return None
 
-        ##整个单元格匹配才替换
-        self.value.sheetData.iloc[
+        if self.value.scaleConf["setValue"] != False:
+            self.setValue(scaleCoordinate, self.value.scaleConf["setValue"])
+
+        ##获取scale级别
+        self.value.scaleData = self.value.sheetData.iloc[
             scaleCoordinate.start[0] - 1: scaleCoordinate.start[0] + scaleCoordinate.rows - 1,
             scaleCoordinate.start[1] - 1: scaleCoordinate.start[1] + scaleCoordinate.columns - 1
-        ].replace(self.value.scaleConf["replaceAll"], inplace=True)
+        ]
+
+        ##整个单元格匹配才替换
+        for replaceAll in self.value.scaleConf["replaceAll"]:
+            if "iniData" in replaceAll and "data" in replaceAll:
+                self.value.scaleData[self.value.scaleData == replaceAll["iniData"]] = replaceAll["data"]
 
         ##单元格内匹配就替换
-        self.value.sheetData.iloc[
-            scaleCoordinate.start[0] - 1: scaleCoordinate.start[0] + scaleCoordinate.rows - 1,
-            scaleCoordinate.start[1] - 1: scaleCoordinate.start[1] + scaleCoordinate.columns - 1
-        ].replace(self.value.scaleConf["replaceSome"], regex=True, inplace=True)
+        for replaceSome in self.value.scaleConf["replaceSome"]:
+            if "iniData" in replaceSome and "data" in replaceSome:
+                self.iniData = replaceSome["iniData"] if isinstance(replaceSome["iniData"], str) else str(replaceSome["iniData"])
+                self.data = replaceSome["data"] if isinstance(replaceSome["data"], str) else str(replaceSome["data"])
+                for i in range(scaleCoordinate.start[0] - 1, scaleCoordinate.start[0] + scaleCoordinate.rows - 1):
+                    for j in range(scaleCoordinate.start[1] - 1,scaleCoordinate.start[1] + scaleCoordinate.columns - 1):
+                        cell = self.value.sheetData.iloc[i, j]
+                        if not isinstance(cell, str): cell = str(cell)
+                        self.value.sheetData.iloc[i, j] = self.replaceSome(cell)
 
         ##调整日期格式
         if self.value.scaleConf["isDateFormat"]:
-            targetFormat = self.value.scaleConf["dateFormat"]["targetFormat"] ##目标格式
+            self.targetFormat = self.value.scaleConf["dateFormat"]["targetFormat"] ##目标格式
             for i in range(scaleCoordinate.start[0] - 1, scaleCoordinate.start[0] + scaleCoordinate.rows - 1):
                 for j in range(scaleCoordinate.start[1] - 1, scaleCoordinate.start[1] + scaleCoordinate.columns - 1):
                     date = self.value.sheetData.iloc[i, j]
                     if not isinstance(date, str): date = str(date)
-                    self.value.sheetData.iloc[i, j] = self.dateFormat(date, targetFormat)
+                    self.value.sheetData.iloc[i, j] = self.dateFormat(date)
 
-        ##填充合并单元格
-        ##单行填充
-        if self.value.scaleConf["fillRows"]:
-            self.fillRows(scaleCoordinate)
-        ##单列填充
-        if self.value.scaleConf["fillColumns"]:
-            self.fillColumns(scaleCoordinate)
+        # ##填充合并单元格
+        # ##单行填充
+        # if self.value.scaleConf["fillRows"]:
+        #     self.fillRows(scaleCoordinate)
+        # ##单列填充
+        # if self.value.scaleConf["fillColumns"]:
+        #     self.fillColumns(scaleCoordinate)
 
-    def setNull(self, scaleCoordinate):
+    def setValue(self, scaleCoordinate, value):
         """
-        设为空值
+        设为指定值
         """
         self.value.sheetData.iloc[
             scaleCoordinate.start[0] - 1: scaleCoordinate.start[0] + scaleCoordinate.rows - 1,
             scaleCoordinate.start[1] - 1: scaleCoordinate.start[1] + scaleCoordinate.columns - 1
-        ] = np.nan
+        ] = value
 
     def fillRows(self, scaleCoordinate):
         """
         单行填充
         """
         for i in range(scaleCoordinate.start[0] - 1, scaleCoordinate.start[0] + scaleCoordinate.rows - 1):
             flag = 0  ##是否处于空值填充范围
@@ -102,15 +117,14 @@
                         flag = 1
 
             if flag == 1:
                 ##补充操作,替换空值
                 y = scaleCoordinate.start[1] + scaleCoordinate.columns - 1
                 self.value.sheetData.iloc[i, start+1:y].fillna(value, inplace=True)
 
-
     def fillColumns(self, scaleCoordinate):
         """
         单列填充
         """
         for i in range(scaleCoordinate.start[1] - 1, scaleCoordinate.start[1] + scaleCoordinate.columns):
             flag = 0  ##是否处于空值填充范围
             preThis = -1;
@@ -140,33 +154,40 @@
             if flag == 1:
                 ##补充操作,替换空值
                 self.value.sheetData[
                 start: end - 1,
                 i
                 ].fillna(value, inplace=True)
 
-    def dateFormat(self, date, targetFormat):
+    def replaceSome(self, cell):
+        if not isinstance(cell, str):
+            cell = str(cell)
+
+        cell = cell.replace(self.iniData, self.data)
+        return cell
+
+    def dateFormat(self, date):
         """
         日期转换
-        :param date: 传入数据
-        :param targetFormat: 目标格式
-        :return:
         """
         ##尝试使用格式转换
+        if not isinstance(date, str):
+            date = str(date)
+
         for dateFormat in self.value.scaleConf["dateFormat"]["format"]:
             try:
-                date = timeTool.dateToStr(timeTool.strToDate(date, dateFormat), targetFormat)
+                date = timeTool.dateToStr(timeTool.strToDate(date, dateFormat), self.targetFormat)
                 return date
             except Exception:
                 pass
 
         ##尝试使用自定义转换器转换
         for dateFormat in self.value.scaleConf["dateFormat"]["dateFormat"]:
             try:
-                date = self.value.extraFuncList[dateFormat](date, targetFormat)
+                date = self.value.dateFormatFunc[dateFormat](date, self.targetFormat)
                 return date
             except Exception as e:
                 pass
 
         if self.value.scaleConf["dateFormat"]["isEmptyWhenFalse"]:
             return ""
         else:
```

### Comparing `excel2db-0.0.5/excel2db/sheet.py` & `excel2db-1.0.0/excel2db/sheet.py`

 * *Files identical despite different names*

### Comparing `excel2db-0.0.5/excel2db/value.py` & `excel2db-1.0.0/excel2db/value.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,14 +1,13 @@
 # -*- coding:utf8 -*-
 """
 变量存放
 """
 # import xmltodict, zipfile, shutil, os
 import inspect
-from . import extraFuction
 
 class value:
     def __init__(self):
         ##excel文件相关
         self.excelFileName = "" ##excel文件名
         self.sheetList = [] ##sheet工作表列表
 
@@ -34,16 +33,14 @@
         self.mainColumnIndex = [] ##选取的主表列编号
         self.detailColumnIndex = []  ##选取的明细表列编号
         self.titleRowIndex = [] ##选取的标题行编号
         self.dataRowIndex = [] ##选取的数据行编号
 
         self.cycleColumns = 0 ##明细表一个循环的列数
 
-        self.extraFuncList = {key:value for key, value in inspect.getmembers(extraFuction)} ##获取额外方法
-
         ##数据库相关
         self.dbClass = None ##数据库操作类
         self.dbConnect = None ##数据库连接
         self.datLoad = ""  ##生成的数据库文件路径
         self.datLoad = "./test.db"
         self.tableName = "" ##当前主表名
         self.tableDtlName = ""##明细表名
@@ -68,14 +65,17 @@
         self.detailDataConf = {}  ##当前的sheet级别配置文件
         self.detailDataConfDown = {}  ##当前的sheet级别向下配置文件
         self.scaleConf = {}  ##当前的scale级别配置文件
 
         ##错误信息
         self.ERRINFO = ""
 
+        ##日期格式化
+        self.dateFormatFunc = {} ##自定义的日期格式化方法
+
     # def getAllSheetNames(self, file_path):
     #     sheets = []
     #     file_name = os.path.splitext(os.path.split(file_path)[-1])[0]
     #     # Make a temporary directory with the file name
     #     directory_to_extract_to = os.path.join(file_name)
     #     os.mkdir(directory_to_extract_to)
     #     # Extract the xlsx file as it is just a zip file
```

